<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–¢–µ—Å—Ç —Ä–∞–∑–¥–µ–ª–∞ –õ–µ–Ω—Ç–∞</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #17212b;
      color: #fff;
      padding: 20px;
    }
    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }
    .tab-btn {
      padding: 10px 20px;
      background: rgba(255,255,255,0.1);
      border: none;
      color: #fff;
      cursor: pointer;
      border-radius: 8px;
    }
    .tab-btn.active {
      background: #10b981;
    }
    #feed-list {
      background: rgba(26, 31, 38, 0.6);
      padding: 20px;
      border-radius: 12px;
    }
    .report-card {
      background: rgba(26, 31, 38, 0.8);
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 16px;
    }
    .challenge-card {
      background: rgba(26, 31, 38, 0.8);
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 16px;
    }
  </style>
</head>
<body>
  <h1>–¢–µ—Å—Ç —Ä–∞–∑–¥–µ–ª–∞ –õ–µ–Ω—Ç–∞</h1>
  
  <div class="tabs">
    <button class="tab-btn active" onclick="showFeedReports()">
      –û—Ç—á—ë—Ç—ã
    </button>
    <button class="tab-btn" onclick="showChallenges('all')">
      –í—Å–µ —á–µ–ª–ª–µ–Ω–¥–∂–∏
    </button>
  </div>

  <div id="feed-list">
    <div style="text-align: center; padding: 40px;">
      <div>–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>
  </div>

  <script>
    // –°–∏–º—É–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    const mockReports = [
      {
        _id: '1',
        _creationTime: Date.now(),
        firstName: '–ò–≤–∞–Ω',
        username: 'ivan123',
        photoUrl: 'https://i.pravatar.cc/150?img=12',
        challengeTitle: '–ü—Ä–æ–±–µ–∂–∞—Ç—å 50–∫–º –∑–∞ –º–µ—Å—è—Ü',
        content: '–°–µ–≥–æ–¥–Ω—è –ø—Ä–æ–±–µ–∂–∞–ª 5–∫–º! –ß—É–≤—Å—Ç–≤—É—é —Å–µ–±—è –æ—Ç–ª–∏—á–Ω–æ üí™',
        imageUrl: null,
        socialLink: null
      },
      {
        _id: '2',
        _creationTime: Date.now() - 3600000,
        firstName: '–ú–∞—Ä–∏—è',
        username: 'maria456',
        photoUrl: 'https://i.pravatar.cc/150?img=5',
        challengeTitle: '–ß–∏—Ç–∞—Ç—å –ø–æ 30 –º–∏–Ω—É—Ç –∫–∞–∂–¥—ã–π –¥–µ–Ω—å',
        content: '–ü—Ä–æ—á–∏—Ç–∞–ª–∞ 2 –≥–ª–∞–≤—ã –∫–Ω–∏–≥–∏ "–ê—Ç–æ–º–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏"',
        imageUrl: null,
        socialLink: 'https://t.me/test'
      },
      {
        _id: '3',
        _creationTime: Date.now() - 7200000,
        firstName: '–ê–ª–µ–∫—Å–µ–π',
        username: 'alex789',
        photoUrl: '',
        challengeTitle: '–ú–µ–¥–∏—Ç–∞—Ü–∏—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å',
        content: '–ú–µ–¥–∏—Ç–∏—Ä–æ–≤–∞–ª 15 –º–∏–Ω—É—Ç —É—Ç—Ä–æ–º',
        imageUrl: null,
        socialLink: null
      }
    ];

    const mockChallenges = [
      {
        _id: '1',
        title: '–ü—Ä–æ–±–µ–∂–∞—Ç—å 50–∫–º –∑–∞ –º–µ—Å—è—Ü',
        description: '–ë–µ–≥–∞—Ç—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –º–∏–Ω–∏–º—É–º 2–∫–º',
        stakeAmount: 1000,
        donationsAmount: 500,
        deadline: new Date(Date.now() + 30*24*60*60*1000).toISOString(),
        status: 'active',
        username: '–ò–≤–∞–Ω'
      },
      {
        _id: '2',
        title: '–ß–∏—Ç–∞—Ç—å –ø–æ 30 –º–∏–Ω—É—Ç –∫–∞–∂–¥—ã–π –¥–µ–Ω—å',
        description: '–†–∞–∑–≤–∏–≤–∞—Ç—å –ø—Ä–∏–≤—ã—á–∫—É —á—Ç–µ–Ω–∏—è',
        stakeAmount: 500,
        donationsAmount: 0,
        deadline: new Date(Date.now() + 20*24*60*60*1000).toISOString(),
        status: 'active',
        username: '–ú–∞—Ä–∏—è'
      }
    ];

    async function showFeedReports() {
      console.log('=== showFeedReports called ===');
      
      const tabs = document.querySelectorAll('.tab-btn');
      tabs.forEach(tab => tab.classList.remove('active'));
      tabs[0].classList.add('active');
      
      const feedList = document.getElementById('feed-list');
      
      feedList.innerHTML = `
        <div style="text-align: center; padding: 40px;">
          <div>–ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç—á—ë—Ç–æ–≤...</div>
        </div>
      `;
      
      // –°–∏–º—É–ª—è—Ü–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏
      await new Promise(resolve => setTimeout(resolve, 500));
      
      const reports = mockReports;
      
      if (reports.length === 0) {
        feedList.innerHTML = `
          <div style="text-align: center; padding: 40px;">
            <div style="font-size: 64px; margin-bottom: 16px;">üìä</div>
            <div>–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç—á—ë—Ç–æ–≤</div>
          </div>
        `;
      } else {
        feedList.innerHTML = reports.map((report, index) => {
          const date = new Date(report._creationTime);
          const dateStr = date.toLocaleDateString('ru-RU');
          const timeStr = date.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
          
          // –ê–≤–∞—Ç–∞—Ä–∫–∞: –µ—Å–ª–∏ –µ—Å—Ç—å photoUrl - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ç–æ, –∏–Ω–∞—á–µ - –ø–µ—Ä–≤—É—é –±—É–∫–≤—É
          const avatarHtml = report.photoUrl 
            ? `<img src="${report.photoUrl}" alt="${report.username}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">` 
            : (report.firstName || report.username).charAt(0).toUpperCase();
          
          return `
            <div class="report-card">
              <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                <div style="display: flex; gap: 12px; align-items: center;">
                  <div style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%); display: flex; align-items: center; justify-content: center; font-weight: 600; overflow: hidden; flex-shrink: 0;">
                    ${avatarHtml}
                  </div>
                  <div>
                    <div style="font-weight: 600;">@${report.username}</div>
                    <div style="opacity: 0.6; font-size: 14px;">${report.challengeTitle}</div>
                  </div>
                </div>
                <div style="opacity: 0.6; font-size: 14px; text-align: right;">
                  ${dateStr}<br>
                  <span style="font-size: 12px; opacity: 0.7;">${timeStr}</span>
                </div>
              </div>
              <div>${report.content}</div>
              ${report.socialLink ? `<a href="${report.socialLink}" target="_blank" style="color: #10b981; margin-top: 8px; display: inline-block;">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å—Ç ‚Üí</a>` : ''}
            </div>
          `;
        }).join('');
      }
    }

    async function showChallenges(type) {
      console.log('=== showChallenges called:', type);
      
      const tabs = document.querySelectorAll('.tab-btn');
      tabs.forEach(tab => tab.classList.remove('active'));
      tabs[1].classList.add('active');
      
      const feedList = document.getElementById('feed-list');
      
      feedList.innerHTML = `
        <div style="text-align: center; padding: 40px;">
          <div>–ó–∞–≥—Ä—É–∑–∫–∞ —á–µ–ª–ª–µ–Ω–¥–∂–µ–π...</div>
        </div>
      `;
      
      // –°–∏–º—É–ª—è—Ü–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏
      await new Promise(resolve => setTimeout(resolve, 500));
      
      const challenges = mockChallenges;
      
      if (challenges.length === 0) {
        feedList.innerHTML = `
          <div style="text-align: center; padding: 40px;">
            <div style="font-size: 64px; margin-bottom: 16px;">üéØ</div>
            <div>–ü–æ–∫–∞ –Ω–µ—Ç —á–µ–ª–ª–µ–Ω–¥–∂–µ–π</div>
          </div>
        `;
      } else {
        feedList.innerHTML = challenges.map((challenge, index) => {
          const deadline = new Date(challenge.deadline);
          const totalAmount = challenge.stakeAmount + (challenge.donationsAmount || 0);
          return `
            <div class="challenge-card">
              <div style="font-weight: 600; margin-bottom: 8px;">${challenge.title}</div>
              <div style="opacity: 0.7; margin-bottom: 12px;">${challenge.description || '–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è'}</div>
              <div style="display: flex; justify-content: space-between; font-size: 14px; opacity: 0.6;">
                <span>${challenge.username}</span>
                <span>${deadline.toLocaleDateString('ru-RU')}</span>
              </div>
              <div style="margin-top: 12px; font-size: 20px; font-weight: 700; color: #10b981;">
                ${totalAmount}
              </div>
            </div>
          `;
        }).join('');
      }
    }

    // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Ç—á—ë—Ç—ã –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
    showFeedReports();
  </script>
</body>
</html>
