# ✅ Чеклист проверки раздела "Лента"

## Перед тестированием

- [ ] Convex запущен (`npm run convex:dev`)
- [ ] Приложение запущено (`npm run dev`)
- [ ] Браузер открыт на `http://localhost:5173`
- [ ] Консоль браузера открыта (F12)

## Проверка данных в БД

### Вариант 1: Через check-data.html
- [ ] Открыт файл `check-data.html` в браузере
- [ ] Видно количество отчётов в БД
- [ ] Видно количество челленджей в БД
- [ ] Нет ошибок подключения к Convex

### Вариант 2: Через консоль браузера
```javascript
// Вставьте в консоль:
const CONVEX_URL = "https://greedy-badger-196.convex.cloud";
fetch(`${CONVEX_URL}/api/query`, {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    path: "challenges:getAllReports",
    args: {},
    format: 'json'
  })
}).then(r => r.json()).then(d => console.log('Reports:', d.value));
```

- [ ] Команда выполнена без ошибок
- [ ] Видно количество отчётов

## Проверка логики переключения вкладок

### Через test-feed.html
- [ ] Открыт файл `test-feed.html` в браузере
- [ ] При загрузке активна вкладка "Отчёты" (фиолетовая)
- [ ] Отображаются 2 тестовых отчёта
- [ ] При клике на "Все челленджи" вкладка переключается
- [ ] Отображаются 2 тестовых челленджа
- [ ] При клике на "Отчёты" вкладка переключается обратно

## Проверка в приложении

### Переход в раздел "Лента"
- [ ] Нажата кнопка "Лента" в нижнем меню
- [ ] Экран переключился на "Лента"
- [ ] В консоли видно: `=== switchScreen called: feed`
- [ ] В консоли видно: `Loading feed reports immediately...`
- [ ] В консоли видно: `=== showFeedReports called ===`

### Вкладка "Отчёты"
- [ ] Вкладка "Отчёты" активна (фиолетовая)
- [ ] Показывается индикатор загрузки
- [ ] В консоли видно: `Fetching reports...`
- [ ] В консоли видно: `Reports received: X [...]`

#### Если отчёты есть в БД:
- [ ] Отображаются карточки отчётов
- [ ] У каждого отчёта есть:
  - [ ] Аватар пользователя (первая буква имени)
  - [ ] Имя пользователя
  - [ ] Название челленджа
  - [ ] Дата создания
  - [ ] Текст отчёта
  - [ ] Фото (если есть)
  - [ ] Ссылка (если есть)
- [ ] В консоли видно: `Reports rendered successfully`

#### Если отчётов нет в БД:
- [ ] Показывается сообщение "Пока нет отчётов"
- [ ] Есть текст "Будьте первым, кто опубликует отчёт о прогрессе!"

### Вкладка "Все челленджи"
- [ ] Нажата вкладка "Все челленджи"
- [ ] Вкладка стала активной (фиолетовая)
- [ ] Вкладка "Отчёты" стала неактивной
- [ ] В консоли видно: `=== showChallenges called: all`
- [ ] В консоли видно: `Switched to "Все челленджи" tab`

#### Если челленджи есть в БД:
- [ ] Отображаются карточки челленджей
- [ ] У каждого челленджа есть:
  - [ ] Название
  - [ ] Описание
  - [ ] Имя пользователя
  - [ ] Дедлайн
  - [ ] Сумма (ставка + донаты)
  - [ ] Бейдж статуса "Активен"
  - [ ] Кнопка "Поддержать" (если не ваш челлендж)

#### Если челленджей нет в БД:
- [ ] Показывается сообщение "Пока нет челленджей"

### Переключение между вкладками
- [ ] Клик на "Отчёты" → вкладка активируется, загружаются отчёты
- [ ] Клик на "Все челленджи" → вкладка активируется, загружаются челленджи
- [ ] Переключение работает плавно без ошибок
- [ ] Нет дублирования данных

## Проверка добавления отчёта

### Создание челленджа (если нет)
- [ ] Перейти в раздел "Профиль"
- [ ] Нажать "Создать челлендж"
- [ ] Заполнить форму:
  - [ ] Название: "Тестовый челлендж"
  - [ ] Описание: "Для проверки отчётов"
  - [ ] Категория: любая
  - [ ] Ставка: 100
  - [ ] Дедлайн: завтра
- [ ] Нажать "Создать и заморозить ставку"
- [ ] Челлендж создан успешно

### Добавление отчёта
- [ ] Нажата кнопка "+" в нижнем меню
- [ ] Открылся экран "Добавить отчёт"
- [ ] В селекте есть созданный челлендж
- [ ] Выбран челлендж
- [ ] Введён текст отчёта: "Тестовый отчёт для проверки"
- [ ] (Опционально) Добавлена ссылка
- [ ] (Опционально) Добавлено фото
- [ ] Нажата кнопка "Опубликовать отчёт"
- [ ] Показано уведомление "Отчёт опубликован!"
- [ ] Автоматически открылся раздел "Лента"
- [ ] Вкладка "Отчёты" активна
- [ ] Новый отчёт отображается в списке

### Проверка отчёта в ленте
- [ ] Отчёт отображается первым (самый новый)
- [ ] Правильное имя пользователя
- [ ] Правильное название челленджа
- [ ] Правильный текст отчёта
- [ ] Фото отображается (если добавлено)
- [ ] Ссылка работает (если добавлена)

## Проверка ошибок

### Нет подключения к Convex
- [ ] Остановить Convex (`Ctrl+C` в терминале)
- [ ] Перейти в раздел "Лента"
- [ ] Показывается ошибка "Ошибка загрузки отчётов"
- [ ] В консоли видна ошибка подключения

### Неправильный URL
- [ ] Изменить `CONVEX_URL` в `app.js` на неправильный
- [ ] Перезагрузить страницу
- [ ] Показывается ошибка загрузки
- [ ] В консоли видна ошибка

## Финальная проверка

- [ ] Все функции работают корректно
- [ ] Нет ошибок в консоли
- [ ] Переключение вкладок работает плавно
- [ ] Отчёты загружаются из БД
- [ ] Челленджи загружаются из БД
- [ ] Добавление отчёта работает
- [ ] UI выглядит правильно
- [ ] Анимации работают

## Если что-то не работает

### Отчёты не загружаются
1. Проверьте `check-data.html` - есть ли отчёты в БД?
2. Проверьте консоль - есть ли ошибки?
3. Проверьте, что Convex запущен
4. Проверьте `CONVEX_URL` в `app.js`

### Вкладки не переключаются
1. Проверьте консоль - вызываются ли функции?
2. Проверьте `test-feed.html` - работает ли там?
3. Проверьте, что CSS загружен
4. Проверьте, что JavaScript загружен

### Челленджи всегда активные
Это нормально! Функция `getAll` загружает только активные челленджи.

## Результат

✅ Всё работает - раздел "Лента" исправлен!
❌ Есть проблемы - см. раздел "Если что-то не работает"
